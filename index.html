<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PANDUO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #0A0A0A;
            color: #E2E8F0;
            background: radial-gradient(circle at 10% 20%, #1A202C, #0A0A0A);
            animation: pulse-bg 15s infinite alternate ease-in-out;
            min-height: 100vh;
        }

        @keyframes pulse-bg {
            0% { background: radial-gradient(circle at 10% 20%, #1A202C, #0A0A0A); }
            100% { background: radial-gradient(circle at 90% 80%, #171923, #0A0A0A); }
        }

        .container-card {
            background-color: #1a1a1a;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4), 0 5px 10px rgba(0, 0, 0, 0.2);
            border: 1px solid #2D3748;
            backdrop-filter: blur(10px);
            border-radius: 1.5rem;
            animation: fade-in 1s ease-out;
        }

        @keyframes fade-in {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .bio-title {
            font-family: 'Montserrat', sans-serif;
            color: #C084FC; /* Een diep paars */
            text-shadow: 0 0 10px rgba(192, 132, 252, 0.5);
        }

        .section-title {
            font-family: 'Montserrat', sans-serif;
            color: #F87171; /* Een zacht rood */
        }

        .link-item {
            background-color: rgba(255, 255, 255, 0.05);
            transition: transform 0.3s, background-color 0.3s, box-shadow 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
        }

        .link-item:hover {
            transform: translateY(-5px);
            background-color: rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }

        .icon-svg {
            color: #4A5568;
            transition: color 0.3s ease-in-out, transform 0.3s ease-in-out;
        }

        .link-item:hover .icon-svg {
            color: #C084FC;
            transform: rotate(10deg) scale(1.1);
        }

        .username-link {
            color: #C084FC;
            text-decoration: underline;
            transition: color 0.3s ease-in-out;
        }

        .username-link:hover {
            color: #F87171;
        }

        .language-button {
            background-color: #C084FC;
            color: #1A202C;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 700;
            transition: background-color 0.3s;
        }

        .language-button:hover {
            background-color: #DDAAFA;
        }
        
        /* Full-screen Overlay Styling */
        #fullscreen-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            z-index: 50;
            transition: opacity 0.3s ease;
        }

        /* LP Animation */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .lp-disk {
            border-radius: 50%;
            transition: transform 0.3s ease-out;
            box-shadow: 0 0 40px rgba(192, 132, 252, 0.5); /* Zachte gloed */
        }

        .lp-spinning {
            animation: spin 3s linear infinite;
        }

        /* Center hole effect */
        .lp-disk::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 15%;
            height: 15%;
            background-color: #0A0A0A;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid #C084FC;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <!-- FULLSCREEN LP OVERLAY -->
    <div id="fullscreen-overlay" class="hidden flex flex-col items-center justify-center p-8">
        <button onclick="toggleFullscreenPlayer(false)" class="absolute top-4 right-4 p-3 rounded-full bg-gray-700/50 hover:bg-gray-700 transition">
            <!-- Close Icon (X) -->
            <svg class="w-6 h-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>

        <div class="text-center max-w-lg w-full">
            <!-- LP Disk -->
            <div class="relative w-64 h-64 sm:w-80 sm:h-80 mx-auto mb-8">
                <img id="lp-art" class="lp-disk w-full h-full object-cover" src="" alt="Album Art LP">
            </div>

            <!-- Track Info -->
            <h4 id="lp-track" class="font-bold text-2xl sm:text-3xl text-white truncate px-4"></h4>
            <p id="lp-artist" class="text-gray-300 text-lg sm:text-xl truncate px-4 mb-2"></p>
            <p id="lp-source" class="text-sm text-purple-400 font-medium"></p>
        </div>
    </div>
    <!-- EINDE FULLSCREEN LP OVERLAY -->

    <!-- HOOFD INHOUD -->
    <div class="container-card p-6 sm:p-10 max-w-2xl lg:max-w-4xl w-full mx-auto">
        
        <!-- Language Switch Button (Gedeeld voor beide talen) -->
        <div class="flex justify-end mb-6">
            <!-- Knop om naar EN te schakelen (zichtbaar in NL weergave) -->
            <button id="lang-toggle-nl" class="language-button" onclick="toggleLanguage('en')">English Version</button>
            <!-- Knop om naar NL te schakelen (zichtbaar in EN weergave) -->
            <button id="lang-toggle-en" class="language-button hidden" onclick="toggleLanguage('nl')">Nederlandse Versie</button>
        </div>

        <!-- NEDERLANDSE INHOUD -->
        <div id="dutch-content">
            <!-- Header/Title -->
            <div class="text-center mb-10 sm:mb-16">
                <h1 class="text-4xl sm:text-6xl font-bold bio-title">PANDUO</h1>
                <p class="mt-2 text-sm sm:text-base text-gray-400">Navigeren door het digitale klanklandschap.</p>
            </div>

            <!-- Muziek & Vibe Sectie (Focused on Last.fm) -->
            <div>
                <h2 class="text-2xl sm:text-3xl font-bold section-title mb-6">Muziek & Vibe</h2>
                
                <!-- Last.fm Obsessie (Top Artiesten) -->
                <div class="w-full mb-8 p-4 bg-gray-800 rounded-lg border border-purple-800/50">
                    <h3 class="text-xl font-bold mb-4 text-purple-300">Last.fm Obsessie (Top Artiesten)</h3>
                    <ul id="obsession-list-nl" class="space-y-2 text-gray-300">
                        <!-- Wordt gevuld door JavaScript -->
                        <li class="text-gray-500">Laden top artiesten...</li>
                    </ul>
                </div>

                <!-- Now Playing - Last.fm API -->
                <div class="w-full">
                    <div class="flex justify-between items-center mb-4">
                         <!-- Dynamische Titel: Wordt 'Momenteel aan het luisteren' of 'Inactief' -->
                        <h3 id="now-playing-title-nl" class="text-xl font-bold">Laden...</h3>
                        <!-- Fullscreen Toggle Button (NL) -->
                        <button id="fullscreen-toggle-nl" onclick="toggleFullscreenPlayer(true)" class="hidden p-2 bg-gray-700/50 hover:bg-gray-700 rounded-full transition" title="Volledig scherm weergave">
                            <!-- View Icon -->
                            <svg class="w-5 h-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                        </button>
                    </div>
                   
                    <div id="now-playing-container-nl" class="flex flex-col items-center justify-center p-4 sm:p-6 bg-gray-800 rounded-lg shadow-inner min-h-[152px]">
                        <!-- Status tekst wanneer verborgen of laden -->
                        <p id="now-playing-status-nl" class="text-gray-400 text-center">Laden...</p>
                        
                        <!-- Track Info met Album Art (zichtbaar bij actieve track) -->
                        <div id="now-playing-info-nl" class="hidden flex flex-col sm:flex-row items-center space-y-3 sm:space-y-0 sm:space-x-4 w-full">
                            <!-- Album Art -->
                            <img id="now-playing-art-nl" class="w-16 h-16 sm:w-20 sm:h-20 rounded-lg shadow-lg flex-shrink-0" src="" alt="Album Art">
                            <!-- Text Info -->
                            <div class="flex-grow min-w-0 text-center sm:text-left">
                                <h4 id="now-playing-track-nl" class="font-bold text-base sm:text-lg text-white truncate"></h4>
                                <p id="now-playing-artist-nl" class="text-gray-300 text-sm truncate"></p>
                                <p id="now-playing-source-nl" class="text-xs text-purple-400 mt-1"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bio Section -->
            <hr class="border-gray-700 my-10">
            <div class="mb-10">
                <h2 class="text-2xl sm:text-3xl font-bold section-title mb-4">Over mij</h2>
                <p class="text-base leading-relaxed text-gray-300">
                    Een creatieve geest met een passie voor zowel het digitale als het hands-on. Hij/Hem, geboren in augustus 2000. Mijn wereld is een mix van het verkennen van nieuwe muziek en het duiken in een verscheidenheid aan gamingwerelden, altijd op zoek naar een nieuwe beat of een nieuwe uitdaging. Dit is mijn digitale ruimte om alles bij te houden. Mijn Reddit is priv√© voor Redditors.
                </p>
            </div>

            <!-- Gaming Section -->
            <hr class="border-gray-700 my-10">
            <div>
                <h2 class="text-2xl sm:text-3xl font-bold section-title mb-6">Gaming</h2>
                <div class="space-y-6">
                    <!-- Now Playing (Gaming) -->
                    <div class="flex flex-col items-center justify-center p-6 link-item text-center">
                        <span class="text-2xl font-bold">Now Playing (Gaming)</span>
                        <p class="text-xs text-gray-400 mt-2">
                            Kan niet live updaten. Bekijk mijn profiel op <a href="https://steamcommunity.com/id/Panduo/" target="_blank" class="username-link">Steam</a>.
                        </p>
                    </div>
                    
                    <!-- Epic Games - Not Clickable -->
                    <div class="flex items-center space-x-6 p-5 link-item">
                        <span class="w-10 h-10 flex-shrink-0">
                            <!-- Spelcontroller SVG -->
                            <svg class="icon-svg w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="2" y="7" width="20" height="10" rx="3"></rect>
                                <path d="M6 10h.01"></path>
                                <path d="M18 10h.01"></path>
                                <path d="M6 14h.01"></path>
                                <path d="M18 14h.01"></path>
                                <path d="M11 12h2"></path>
                                <path d="M12 11v2"></path>
                            </svg>
                        </span>
                        <span class="text-lg font-medium">Fortnite / Epic | UnoPanduo</span>
                    </div>
                    <!-- Steam -->
                    <a href="https://steamcommunity.com/id/Panduo/" target="_blank" class="flex items-center space-x-6 p-5 link-item">
                        <span class="w-10 h-10 flex-shrink-0">
                            <!-- Spelcontroller SVG -->
                            <svg class="icon-svg w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="2" y="7" width="20" height="10" rx="3"></rect>
                                <path d="M6 10h.01"></path>
                                <path d="M18 10h.01"></path>
                                <path d="M6 14h.01"></path>
                                <path d="M18 14h.01"></path>
                                <path d="M11 12h2"></path>
                                <path d="M12 11v2"></path>
                            </svg>
                        </span>
                        <span class="text-lg font-medium">Steam Profiel | <span class="username-link">Panduo</span></span>
                    </a>
                    <!-- EA -->
                    <a href="#" target="_blank" class="flex items-center space-x-6 p-5 link-item">
                        <span class="w-10 h-10 flex-shrink-0">
                            <!-- Spelcontroller SVG -->
                            <svg class="icon-svg w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="2" y="7" width="20" height="10" rx="3"></rect>
                                <path d="M6 10h.01"></path>
                                <path d="M18 10h.01"></path>
                                <path d="M6 14h.01"></path>
                                <path d="M18 14h.01"></path>
                                <path d="M11 12h2"></path>
                                <path d="M12 11v2"></path>
                            </svg>
                        </span>
                        <span class="text-lg font-medium">EA Profiel | <span class="username-link">Niet verstrekt</span></span>
                    </a>
                </div>
            </div>

            <!-- Social Section -->
            <hr class="border-gray-700 my-10">
            <div>
                <h2 class="text-2xl sm:text-3xl font-bold section-title mb-6">Socials</h2>
                <div class="space-y-6">
                    <!-- Discord - No link -->
                    <div class="flex items-center space-x-6 p-5 link-item">
                        <span class="text-lg font-medium">Discord | UnoPanduo</span>
                    </div>

                    <!-- YouTube -->
                    <a href="https://www.youtube.com/@UnoPanduo" target="_blank" class="flex items-center space-x-6 p-5 link-item">
                        <span class="w-10 h-10 flex-shrink-0">
                            <!-- Afspelen SVG -->
                            <svg class="icon-svg w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M8 5v14l11-7z"></path>
                            </svg>
                        </span>
                        <span class="text-lg font-medium">YouTube-kanaal | <span class="username-link">@UnoPanduo</span></span>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- ENGELSE INHOUD -->
        <div id="english-content" class="hidden">
            <!-- Header/Title -->
            <div class="text-center mb-10 sm:mb-16">
                <h1 class="text-4xl sm:text-6xl font-bold bio-title">PANDUO</h1>
                <p class="mt-2 text-sm sm:text-base text-gray-400">Navigating the digital soundscape.</p>
            </div>

            <!-- Music & Vibe Section (Focused on Last.fm) -->
            <div>
                <h2 class="text-2xl sm:text-3xl font-bold section-title mb-6">Music & Vibe</h2>
                
                 <!-- Last.fm Obsession (Top Artists) -->
                 <div class="w-full mb-8 p-4 bg-gray-800 rounded-lg border border-purple-800/50">
                    <h3 class="text-xl font-bold mb-4 text-purple-300">Last.fm Obsession (Top Artists)</h3>
                    <ul id="obsession-list-en" class="space-y-2 text-gray-300">
                        <!-- Filled by JavaScript -->
                        <li class="text-gray-500">Loading top artists...</li>
                    </ul>
                </div>

                <!-- Now Playing - Last.fm API -->
                <div class="w-full">
                    <div class="flex justify-between items-center mb-4">
                        <!-- Dynamic Title: Will be 'Currently Listening' or 'Inactive' -->
                        <h3 id="now-playing-title-en" class="text-xl font-bold">Loading...</h3>
                        <!-- Fullscreen Toggle Button (EN) -->
                        <button id="fullscreen-toggle-en" onclick="toggleFullscreenPlayer(true)" class="hidden p-2 bg-gray-700/50 hover:bg-gray-700 rounded-full transition" title="Full screen view">
                             <!-- View Icon -->
                             <svg class="w-5 h-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                        </button>
                    </div>
                    
                    <div id="now-playing-container-en" class="flex flex-col items-center justify-center p-4 sm:p-6 bg-gray-800 rounded-lg shadow-inner min-h-[152px]">
                        <!-- Status text when hidden or loading -->
                        <p id="now-playing-status-en" class="text-gray-400 text-center">Loading...</p>
                        
                        <!-- Track Info met Album Art (visible when track is active) -->
                        <div id="now-playing-info-en" class="hidden flex flex-col sm:flex-row items-center space-y-3 sm:space-y-0 sm:space-x-4 w-full">
                            <!-- Album Art -->
                            <img id="now-playing-art-en" class="w-16 h-16 sm:w-20 sm:h-20 rounded-lg shadow-lg flex-shrink-0" src="" alt="Album Art">
                            <!-- Text Info -->
                            <div class="flex-grow min-w-0 text-center sm:text-left">
                                <h4 id="now-playing-track-en" class="font-bold text-base sm:text-lg text-white truncate"></h4>
                                <p id="now-playing-artist-en" class="text-gray-300 text-sm truncate"></p>
                                <p id="now-playing-source-en" class="text-xs text-purple-400 mt-1"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bio Section -->
            <hr class="border-gray-700 my-10">
            <div class="mb-10">
                <h2 class="text-2xl sm:text-3xl font-bold section-title mb-4">About Me</h2>
                <p class="text-base leading-relaxed text-gray-300">
                    A creative mind with a passion for both the digital and the hands-on. He/Him, born in August 2000. My world is a blend of exploring new music and diving into a variety of gaming realms, always looking for a new beat or a new challenge. This is my digital space to keep track of everything. My Reddit is private for Redditors.
                </p>
            </div>

            <!-- Gaming Section -->
            <hr class="border-gray-700 my-10">
            <div>
                <h2 class="text-2xl sm:text-3xl font-bold section-title mb-6">Gaming</h2>
                <div class="space-y-6">
                    <!-- Now Playing (Gaming) -->
                    <div class="flex flex-col items-center justify-center p-6 link-item text-center">
                        <span class="text-2xl font-bold">Now Playing (Gaming)</span>
                        <p class="text-xs text-gray-400 mt-2">
                            Cannot update live. View my profile on <a href="https://steamcommunity.com/id/Panduo/" target="_blank" class="username-link">Steam</a>.
                        </p>
                    </div>
                    
                    <!-- Epic Games - Not Clickable -->
                    <div class="flex items-center space-x-6 p-5 link-item">
                        <span class="w-10 h-10 flex-shrink-0">
                            <!-- Game Controller SVG -->
                            <svg class="icon-svg w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="2" y="7" width="20" height="10" rx="3"></rect>
                                <path d="M6 10h.01"></path>
                                <path d="M18 10h.01"></path>
                                <path d="M6 14h.01"></path>
                                <path d="M18 14h.01"></path>
                                <path d="M11 12h2"></path>
                                <path d="M12 11v2"></path>
                            </svg>
                        </span>
                        <span class="text-lg font-medium">Fortnite / Epic | UnoPanduo</span>
                    </div>
                    <!-- Steam -->
                    <a href="https://steamcommunity.com/id/Panduo/" target="_blank" class="flex items-center space-x-6 p-5 link-item">
                        <span class="w-10 h-10 flex-shrink-0">
                            <!-- Game Controller SVG -->
                            <svg class="icon-svg w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="2" y="7" width="20" height="10" rx="3"></rect>
                                <path d="M6 10h.01"></path>
                                <path d="M18 10h.01"></path>
                                <path d="M6 14h.01"></path>
                                <path d="M18 14h.01"></path>
                                <path d="M11 12h2"></path>
                                <path d="M12 11v2"></path>
                            </svg>
                        </span>
                        <span class="text-lg font-medium">Steam Profile | <span class="username-link">Panduo</span></span>
                    </a>
                    <!-- EA -->
                    <a href="#" target="_blank" class="flex items-center space-x-6 p-5 link-item">
                        <span class="w-10 h-10 flex-shrink-0">
                            <!-- Game Controller SVG -->
                            <svg class="icon-svg w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="2" y="7" width="20" height="10" rx="3"></rect>
                                <path d="M6 10h.01"></path>
                                <path d="M18 10h.01"></path>
                                <path d="M6 14h.01"></path>
                                <path d="M18 14h.01"></path>
                                <path d="M11 12h2"></path>
                                <path d="M12 11v2"></path>
                            </svg>
                        </span>
                        <span class="text-lg font-medium">EA Profile | <span class="username-link">Not provided</span></span>
                    </a>
                </div>
            </div>

            <!-- Social Section -->
            <hr class="border-gray-700 my-10">
            <div>
                <h2 class="text-2xl sm:text-3xl font-bold section-title mb-6">Socials</h2>
                <div class="space-y-6">
                    <!-- Discord - No link -->
                    <div class="flex items-center space-x-6 p-5 link-item">
                        <span class="text-lg font-medium">Discord | UnoPanduo</span>
                    </div>

                    <!-- YouTube -->
                    <a href="https://www.youtube.com/@UnoPanduo" target="_blank" class="flex items-center space-x-6 p-5 link-item">
                        <span class="w-10 h-10 flex-shrink-0">
                            <!-- Play SVG -->
                            <svg class="icon-svg w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M8 5v14l11-7z"></path>
                            </svg>
                        </span>
                        <span class="text-lg font-medium">YouTube Channel | <span class="username-link">@UnoPanduo</span></span>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // !!! LAST.FM INSTELLINGEN (ALTIJD CONTROLEREN) !!!
        const LASTFM_API_KEY = 'a1e23f2502881d4d5ce462128b81bb7b'; 
        const LASTFM_USERNAME = 'ItsDapanda';
        
        // Timerinstellingen
        const API_POLLING_INTERVAL = 10000; // 10 seconden voor API-check
        // 5 minuten in milliseconden
        const FIVE_MINUTE_LIMIT_MS = 5 * 60 * 1000; 
        const PLACEHOLDER_ART = 'https://placehold.co/80x80/2D3748/C084FC?text=LP';
        
        // Standaardteksten
        const NOT_SHOWN_TITLE_NL = 'Inactief';
        const NOT_SHOWN_TITLE_EN = 'Inactive';
        const NOT_SHOWN_STATUS_NL = 'Geen live stream, en de laatste scrobble is meer dan 5 minuten geleden.';
        const NOT_SHOWN_STATUS_EN = 'No live stream, and the last scrobble was more than 5 minutes ago.';
        const PLAYING_TITLE_NL = 'Momenteel aan het luisteren';
        const PLAYING_TITLE_EN = 'Currently Listening';
        
        let apiPollingInterval = null; 

        // Globale variabelen om de huidige staat van de track op te slaan
        let currentTrack = {
            name: '',
            artist: '',
            artUrl: PLACEHOLDER_ART,
            sourceNl: '',
            sourceEn: '',
            isLive: false,
            isActive: false // Binnen de 5-minuten limiet OF live
        };

        /**
         * Haalt de Last.fm Top Artiesten op en vult de 'Obsessie' lijst.
         */
        async function fetchLastFmObsession() {
            const url = `https://ws.audioscrobbler.com/2.0/?method=user.gettopartists&user=${LASTFM_USERNAME}&api_key=${LASTFM_API_KEY}&format=json&limit=5`;

            try {
                const response = await fetch(url);
                const data = await response.json();

                const artists = data.topartists?.artist;

                if (artists && artists.length > 0) {
                    const renderList = (lang) => {
                        const listEl = document.getElementById(`obsession-list-${lang}`);
                        listEl.innerHTML = ''; // Clear previous content

                        artists.forEach((artist, index) => {
                            const listItem = document.createElement('li');
                            // Tailwind classes for styling the list item
                            listItem.className = 'flex justify-between items-center p-2 bg-gray-700/30 rounded-md';
                            
                            const rank = index + 1;
                            
                            // Link naar Last.fm profiel van de artiest
                            const artistLink = artist.url || '#'; 
                            const playcount = artist.playcount.toLocaleString('en-US');

                            listItem.innerHTML = `
                                <a href="${artistLink}" target="_blank" class="text-sm font-medium hover:text-purple-400 transition truncate mr-4">
                                    <span class="font-bold text-red-300 mr-2">${rank}.</span> ${artist.name}
                                </a>
                                <span class="text-xs text-gray-400 font-mono flex-shrink-0">${playcount} plays</span>
                            `;
                            listEl.appendChild(listItem);
                        });
                    };
                    
                    renderList('nl');
                    renderList('en');

                } else {
                    const messageNl = 'Geen top artiesten gevonden.';
                    const messageEn = 'No top artists found.';
                    document.getElementById('obsession-list-nl').innerHTML = `<li class="text-gray-500 p-2">${messageNl}</li>`;
                    document.getElementById('obsession-list-en').innerHTML = `<li class="text-gray-500 p-2">${messageEn}</li>`;
                }

            } catch (error) {
                console.error("Fout bij het laden van Last.fm Top Artiesten:", error);
                const errorHtmlNl = '<li class="text-red-400 p-2">Fout: Kon Last.fm obsessie niet laden.</li>';
                const errorHtmlEn = '<li class="text-red-400 p-2">Error: Could not load Last.fm obsession.</li>';
                document.getElementById('obsession-list-nl').innerHTML = errorHtmlNl;
                document.getElementById('obsession-list-en').innerHTML = errorHtmlEn;
            }
        }


        /**
         * Schakelt de full-screen LP-speler aan/uit en vult de details in.
         * @param {boolean} show True om te tonen, False om te verbergen.
         */
        function toggleFullscreenPlayer(show) {
            const overlay = document.getElementById('fullscreen-overlay');
            const lpArt = document.getElementById('lp-art');
            const lpTrack = document.getElementById('lp-track');
            const lpArtist = document.getElementById('lp-artist');
            const lpSource = document.getElementById('lp-source');
            const currentLang = localStorage.getItem('language') || 'nl';

            if (show && currentTrack.isActive) {
                // Toon de modal
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Voorkom scrollen in de achtergrond
                
                // Vul de details in
                lpTrack.textContent = currentTrack.name;
                lpArtist.textContent = currentTrack.artist;
                lpArt.src = currentTrack.artUrl;
                lpSource.textContent = currentLang === 'nl' ? currentTrack.sourceNl : currentTrack.sourceEn;

                // Start het spinnen alleen als de stream LIVE is
                if (currentTrack.isLive) {
                    lpArt.classList.add('lp-spinning');
                } else {
                    lpArt.classList.remove('lp-spinning');
                }

            } else {
                // Verberg de modal
                overlay.classList.add('hidden');
                document.body.style.overflow = ''; // Herstel scrollen
                lpArt.classList.remove('lp-spinning');
            }
        }
        
        /**
         * Functie om de taal te wisselen.
         * Verbergt ook de knop voor de taal die al actief is.
         */
        function toggleLanguage(lang) {
            const dutchContent = document.getElementById('dutch-content');
            const englishContent = document.getElementById('english-content');
            const toggleNl = document.getElementById('lang-toggle-nl'); 
            const toggleEn = document.getElementById('lang-toggle-en'); 

            if (lang === 'en') {
                dutchContent.classList.add('hidden');
                englishContent.classList.remove('hidden');
                toggleNl.classList.add('hidden');
                toggleEn.classList.remove('hidden');
                localStorage.setItem('language', 'en');
            } else {
                dutchContent.classList.remove('hidden');
                englishContent.classList.add('hidden');
                toggleNl.classList.remove('hidden'); 
                toggleEn.classList.add('hidden');
                localStorage.setItem('language', 'nl');
            }
        }
        
        /**
         * Haalt de Last.fm status op en werkt de UI bij op basis van de 5-minuten regel.
         */
        async function fetchLastFmStatus() {
            const url = `https://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=${LASTFM_USERNAME}&api_key=${LASTFM_API_KEY}&format=json&limit=1`;

            // Reset de globale track status
            currentTrack.isLive = false;
            currentTrack.isActive = false;

            const setErrorUI = (messageNl, messageEn) => {
                ['nl', 'en'].forEach(lang => {
                    document.getElementById(`now-playing-title-${lang}`).textContent = lang === 'nl' ? "Fout" : "Error";
                    document.getElementById(`now-playing-status-${lang}`).textContent = lang === 'nl' ? messageNl : messageEn;
                    document.getElementById(`now-playing-status-${lang}`).classList.remove('hidden');
                    document.getElementById(`now-playing-info-${lang}`).classList.add('hidden');
                    document.getElementById(`fullscreen-toggle-${lang}`).classList.add('hidden');
                });
            };

            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP fout! Status: ${response.status}`);
                const data = await response.json();
                if (data.error) throw new Error(`Last.fm API gerapporteerde fout: ${data.message}`);

                const tracks = data.recenttracks?.track;
                let trackName = '';
                let artistName = '';
                let albumArtUrl = PLACEHOLDER_ART; 

                if (tracks && tracks.length > 0) {
                    const track = tracks[0];
                    trackName = track.name;
                    artistName = track.artist['#text'];

                    if (track.image && track.image.length > 3 && track.image[3]['#text']) {
                        albumArtUrl = track.image[3]['#text'] || PLACEHOLDER_ART;
                    }

                    // 1. Controleer of de track momenteel live wordt afgespeeld
                    const isPlayingLive = (track['@attr'] && track['@attr'].nowplaying === 'true');
                    
                    if (isPlayingLive) {
                        currentTrack.isActive = true;
                        currentTrack.isLive = true;
                        currentTrack.sourceNl = 'Live Stream (Muziekdienst)';
                        currentTrack.sourceEn = 'Live Stream (Music Service)';
                    } 
                    // 2. Controleer of de laatst gescrobbelde track minder dan 5 minuten geleden was
                    else if (track.date && track.date.uts) {
                        const trackTimestampMs = parseInt(track.date.uts) * 1000;
                        const currentTimeMs = Date.now();
                        const timeDifferenceMs = currentTimeMs - trackTimestampMs;

                        if (timeDifferenceMs < FIVE_MINUTE_LIMIT_MS) {
                            currentTrack.isActive = true;
                            currentTrack.sourceNl = 'Laatst gespeeld (minder dan 5m geleden)';
                            currentTrack.sourceEn = 'Last Played (less than 5m ago)';
                        }
                    }
                    
                    // Update globale track details
                    currentTrack.name = trackName;
                    currentTrack.artist = artistName;
                    currentTrack.artUrl = albumArtUrl;

                } 
                
                // Functie om de UI te updaten voor een specifieke taal
                function updateUI(lang, show) {
                    const statusEl = document.getElementById(`now-playing-status-${lang}`);
                    const infoEl = document.getElementById(`now-playing-info-${lang}`);
                    const trackEl = document.getElementById(`now-playing-track-${lang}`);
                    const artistEl = document.getElementById(`now-playing-artist-${lang}`);
                    const artEl = document.getElementById(`now-playing-art-${lang}`);
                    const sourceEl = document.getElementById(`now-playing-source-${lang}`);
                    const titleEl = document.getElementById(`now-playing-title-${lang}`);
                    const toggleButton = document.getElementById(`fullscreen-toggle-${lang}`);
                    
                    if (show) {
                        // Toon de actieve track
                        statusEl.classList.add('hidden');
                        infoEl.classList.remove('hidden');
                        toggleButton.classList.remove('hidden'); // Toon de fullscreen knop
                        
                        titleEl.textContent = lang === 'nl' ? PLAYING_TITLE_NL : PLAYING_TITLE_EN;
                        trackEl.textContent = currentTrack.name;
                        artistEl.textContent = currentTrack.artist;
                        artEl.src = currentTrack.artUrl;
                        artEl.onerror = () => artEl.src = PLACEHOLDER_ART; 
                        sourceEl.textContent = lang === 'nl' ? currentTrack.sourceNl : currentTrack.sourceEn;
                    } else {
                        // Toon de inactieve status
                        infoEl.classList.add('hidden');
                        statusEl.classList.remove('hidden');
                        toggleButton.classList.add('hidden'); // Verberg de fullscreen knop
                        
                        titleEl.textContent = lang === 'nl' ? NOT_SHOWN_TITLE_NL : NOT_SHOWN_TITLE_EN;
                        statusEl.textContent = lang === 'nl' ? NOT_SHOWN_STATUS_NL : NOT_SHOWN_STATUS_EN;
                    }
                }

                // Update voor beide talen
                updateUI('nl', currentTrack.isActive);
                updateUI('en', currentTrack.isActive);

            } catch (error) {
                console.error("Fatale Fout bij Last.fm:", error);
                const errorTextNl = "Fout: Last.fm gegevens konden niet geladen worden.";
                const errorTextEn = "Error: Last.fm data failed to load.";
                setErrorUI(errorTextNl, errorTextEn);
            }
        }
        
        // Initialisatie
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Stel de taal in
            const savedLang = localStorage.getItem('language') || 'nl'; 
            toggleLanguage(savedLang);

            // 2. Laad de Obsessie data (eenmalig)
            fetchLastFmObsession(); 

            // 3. Start de Now Playing Polling
            fetchLastFmStatus();
            apiPollingInterval = setInterval(fetchLastFmStatus, API_POLLING_INTERVAL);
        });
    </script>
</body>
